# Documentation: http://docs.travis-ci.com/user/languages/julia/
# This file was addepted from https://github.com/stevengj/xsumBuilder/
# See discussion at
# https://discourse.julialang.org/t/julia-package-to-wrap-a-c-library/26749/2
language: julia
os:
  - linux
julia:
  - 1.4
notifications:
  email: false
git:
  depth: 99999999
cache:
  timeout: 1000
  directories:
  - downloads
env:
  global:
  - BINARYBUILDER_DOWNLOADS_CACHE=downloads
  - BINARYBUILDER_AUTOMATIC_APPLE=true
sudo: required
before_script:
  - julia -e 'using Pkg; pkg"add BinaryProvider"; pkg"add BinaryBuilder"; Pkg.build()'
script:
  - julia build_tarballs.jl x86_64-linux-gnu
deploy:
  provider: releases
  file: products/*
  overwrite: true
  # Make sure you have skip_cleanup set to true, otherwise Travis CI will
  # delete all the files created during the build, which will probably delete
  # what you are trying to upload.
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  on:
    repo: emmt/OptimPackBuilder
    tags: false
    branch: master
